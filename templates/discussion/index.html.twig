{# templates/discussions.html.twig #}

{% extends 'base.html.twig' %}

{% block title %}Discussions Agricoles{% endblock %}

{% block css %}
    {{ parent() }}
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-image: url('https://source.unsplash.com/1600x900/?farm,field');
            background-size: cover;
            background-position: center;
        }
    </style>
{% endblock %}

{% block body %}


<!-- Page Header Start -->
<div class="container-fluid page-header py-5 wow fadeIn" data-wow-delay="0.1s">
    <div class="container text-center py-5">
        <h1 class="display-2 text-dark mb-4 animated slideInDown">Discussions</h1>
        <nav aria-label="breadcrumb animated slideInDown">
            <ol class="breadcrumb justify-content-center mb-0">
                <li class="breadcrumb-item"><a href="{{ path('home') }}">Home</a></li>
                <li class="breadcrumb-item"><a href="#">Pages</a></li>
                <li class="breadcrumb-item text-dark" aria-current="page">Discussions</li>
            </ol>
        </nav>
    </div>
</div>
<!-- Page Header End -->
    <div class="max-w-5xl mx-auto mt-10 p-6 bg-white shadow-lg rounded-lg backdrop-blur-md bg-opacity-90">
        <h1 class="text-3xl font-bold text-green-700 mb-6">üå± Discussions Agricoles</h1>
        
        <!-- Search Bar -->
        {# <input type="text" id="rechercheField" class="w-full p-3 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="üîç Rechercher une discussion..."> #}

        <!-- Table -->
        <div class="mt-6 overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300 rounded-lg shadow-md">
                <thead class="bg-green-600 text-white">
                    <tr>
                        <th class="py-4 px-6 text-left">üåæ Titre</th>
                        <th class="py-4 px-6 text-left">üìÖ Date de Cr√©ation</th>
                        <th class="py-4 px-6 text-left">‚öôÔ∏è Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for discussion in discussions %}
                    <tr class="border-b hover:bg-green-50 transition">
                        <td class="py-4 px-6">{{ discussion.titre }}</td>
                        <td class="py-4 px-6">{{ discussion.dateCreation|date('Y-m-d H:i:s') }}</td>
                        <td class="py-4 px-6 flex gap-3">
                            <a href="{{ path('add_message', {id: discussion.id})}}" class="px-5 py-2 bg-green-600 text-white rounded-md hover:bg-green-500 transition">Ouvrir</a>
                            <button onclick="confirmDelete('{{ path('delete_discussion', {'idDiscussion': discussion.id}) }}')" class="px-5 py-2 bg-red-500 text-white rounded-md hover:bg-red-400 transition">Supprimer</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Add Discussion Button -->
        <div class="mt-6 flex justify-end">
            <a href="{{ path ('add_discussion') }}" class="px-6 py-3 bg-yellow-500 text-white rounded-lg shadow-md hover:bg-yellow-400 transition">‚ûï Ajouter une discussion</a>
        </div>
    </div>

    <script>
    function confirmDelete(deleteUrl) {
        if (confirm('Are you sure you want to delete this message?')) {
            window.location.href = deleteUrl;
        }
    }
        {# function confirmDelete(deleteUrl) {
            if (confirm('Voulez-vous vraiment supprimer cette discussion ?')) {
                window.location.href = deleteUrl;
            }
        }

        const searchField = document.getElementById('rechercheField');
        searchField.addEventListener('input', () => {
            const searchTerm = searchField.value.toLowerCase();
            document.querySelectorAll('tbody tr').forEach(row => {
                const title = row.querySelector('td:first-child').textContent.toLowerCase();
                row.style.display = title.includes(searchTerm) ? 'table-row' : 'none';
            });
        }); #}
    </script>
{% endblock %}

{% block js %}
    {{ parent() }}
    <!-- Additional JavaScript for this page -->
{% endblock %}